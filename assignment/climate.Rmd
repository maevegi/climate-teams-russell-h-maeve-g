---
title: "Changing Climate Indicators"
author: "Maeve Gilbert & Russell Huang"
output: github_document
---



# Unit I: Climate Change Module

## Warm-up exercise: Examining CO2 trends in R

- Example from <http://climate.nasa.gov/vital-signs/carbon-dioxide/>
- Raw data from <https://gml.noaa.gov/webdata/ccgg/trends/co2/co2_mm_mlo.txt>

```{r message=FALSE}
library(tidyverse)
```

```{r message=FALSE}

co2 <- 
read_table("https://gml.noaa.gov/webdata/ccgg/trends/co2/co2_mm_mlo.txt", 
                  comment="#",
                  col_names = c("year", "month", "decimal_date", "monthly_average",
                                "interpolated", "days", "std", "uncertainty"),
                  na = c("-1", "-9.99", "-0.99"),
           col_types = "iidddddd")
co2
```


```{r}
co2|> pivot_longer(c("monthly_average", "interpolated"), values_to="co2", names_to="type")|>
ggplot(aes(x = decimal_date, y = co2, col=type)) +
  geom_line()+ theme_bw()

```
This data represents the monthly observations of atmospheric CO2 concentrations collected from the Mauna Loa Observatory in Hawaii. The data ranges from 1958 to the present. CO2 values fluctuate througought the year as CO2 uptake increases during the growing months of spring and summer and is released again through decomposition in the fall and winter. 


------------------------

# Exercise I: Temperature Data

Each of the last years has consecutively set new records on global climate.  In this section we will analyze global mean temperature data.

Data from: <http://climate.nasa.gov/vital-signs/global-temperature>

## Question 1:

Describe the data set to the best of your ability given the documentation provided.  Describe what kind of column each data contains and what units it is measured in.  Then address our three key questions in understanding this data:

- How are the measurements made? What is the associated measurement uncertainty?
The measurements displayed are collected from NASA's Goddard Institute Institute for Space studies. The data includes the global average surface temperature from 1880 to 2022. The measurements are made as the change in surface temperature compared to the global average from 1951 to 1980. The measurement uncertainty is Lowess smoothing, which averages the data. The data is measured in annual mean temperature in Celsius. The only obvious gap in data is temperature data pre-1880, since global measurements of temperature were not consistently available.

## Question 2:

Construct the necessary R code to import and prepare for manipulation the following data set: <http://climate.nasa.gov/system/internal_resources/details/original/647_Global_Temperature_Data_File.txt>

```{r}
global_temp<-
read_table("https://data.giss.nasa.gov/gistemp/graphs/graph_data/Global_Mean_Estimates_based_on_Land_and_Ocean_Data/graph.txt",
           skip=5, 
           col_names= c("year", "annual_mean", "lowess_smoothing"),
           show_col_types=FALSE)

global_temp
```


## Question 3:

Plot the trend in global mean temperatures over time.  Describe what you see in the plot and how you interpret the patterns you observe.
```{r}
ggplot(global_temp, aes(x=year))+
         geom_line(mapping=aes(y=annual_mean), col="red")+
         geom_line(mapping=aes(y=lowess_smoothing), col="blue")
```
The graph plots the the annual mean temperature from 1880 to the present. The red line represents the annual mean temperature, while the blue line represents the Lowess smoothing. The data fluctuates consistently between 1880 to around 1930, generally decreasing. However, at around 1930, the mean temperature variation sharply increased, likely due to increased CO2 emissions from intensified production during the two world wars. Greater CO2 emissions led to a stronger greenhoue effect, which therefore increased the global mean temperature. After this period, the annual mean temperature continued increasing.  



## Question 4: Evaluating the evidence for a "Pause" in warming?

The [2013 IPCC Report](https://www.ipcc.ch/pdf/assessment-report/ar5/wg1/WG1AR5_SummaryVolume_FINAL.pdf) included a tentative observation of a "much smaller increasing trend" in global mean temperatures since 1998 than was observed previously.  This led to much discussion in the media about the existence of a "Pause" or "Hiatus" in global warming rates, as well as much research looking into where the extra heat could have gone.  (Examples discussing this question include articles in [The Guardian](http://www.theguardian.com/environment/2015/jun/04/global-warming-hasnt-paused-study-finds), [BBC News](http://www.bbc.com/news/science-environment-28870988), and [Wikipedia](https://en.wikipedia.org/wiki/Global_warming_hiatus)). 

By examining the data here, what evidence do you find or not find for such a pause?  Present an analysis of this data (using the tools & methods we have covered in Foundation course so far) to argue your case.  

What additional analyses or data sources would better help you refine your arguments?

# Exercise II: Melting Ice Sheets?

- Data description: <http://climate.nasa.gov/vital-signs/land-ice/>
- Raw data file: <http://climate.nasa.gov/system/internal_resources/details/original/499_GRN_ANT_mass_changes.csv>

## Question 1:

The following data set represents the amount Antarctic and Greenland ice mass per year. The mass of the ice is measured in gigatons per year. The columns are year, Antarctic mass, and Greenland ice mass. The data comes from NASA's GRACE and GRACE follow-on satellites.
There are some missing values in the data, ranging from around June of 2017 to June of 2018 after the first GRACE mission was ended. It resumed in 2018 when the GRACE Follow-On mission began. The data was collected monthly between 2002 to the present day.  

## Question 2:

Construct the necessary R code to import this data set as a tidy `Table` object.

```{r}
ice_original <- read_csv("http://climate.nasa.gov/system/internal_resources/details/original/499_GRN_ANT_mass_changes.csv",
                skip=10,
                col_names=c("decimal_date", "greenland_mass", "antarctic_mass"),
                col_types="ddd")
                
          
ice_original
```
```{r}
ice_new<-ice_original%>%
  pivot_longer(greenland_mass:antarctic_mass, values_to="ice_mass", names_to="location")
ice_new
```
```{r}
ice_new %>%
  ggplot()+
  geom_line(aes(x=decimal_date, y=ice_mass, color=location))
```
The above data is listed as a table differentiated by the year plotted against Greenland and Antarctic mass. It is then listed again as a consolidated table in order to plot the data. Both locations on the plot display small seasonal variations in ice mass as ice melts in the spring and reforms in the winter. However, both locations display an overall decline in ice mass. The Greenland ice mass appears to follow a fairly regular decline, while the Antarctic ice mass data has greater variation. Additionally, the rate of change for the Greenland ice is almost twice as fast as that of the Antarctic ice. 

# Exercise III: Rising Sea Levels?

- Data description: <http://climate.nasa.gov/vital-signs/sea-level/>
- Raw data file: <http://climate.nasa.gov/system/internal_resources/details/original/121_Global_Sea_Level_Data_File.txt>


## Question 1:
This table is measuring the Global Mean Sea Level (GMSL) variation measured in millimeters every month from 1993 until the present. The data was gathered by the NASA Goddard Space Flight Center and represents a compilation of teh Sea Surace Heights from multiple satelittes. The original data file contains twelve different columns, including the year, number of obseravations, weighted observations, and mutiple GMSL measurements with different filters applied. For the purposes of our observations, we used the data on the time that the observation was collected, and the the smooth GMSL variation with the annual and semi-annual signal removed. We chose this data column because it was the same as that used by NASA in their figures. 

## Question 2:

Construct the necessary R code to import this data set as a tidy `Table` object.
```{r}
sea_level<-read_table("http://climate.nasa.gov/system/internal_resources/details/original/121_Global_Sea_Level_Data_File.txt",

                      skip=30,
                      comment="HDR",
                      col_names=c("a", "b", "decimal_date","c", "d",
                      "e", "f", "g", "h", "i", "j", "height_variation"),
                      show_col_types=FALSE)
sea_level<-select(sea_level, decimal_date, height_variation)
sea_level
```

## Question 3:

Plot the data and describe the trends you observe.
```{r}
ggplot(data=sea_level)+
geom_line(mapping=aes(x=decimal_date, y=height_variation), color="orange")
```

# Exercise IV: Arctic Sea Ice?

- <http://nsidc.org/data/G02135>
- <ftp://sidads.colorado.edu/DATASETS/NOAA/G02135/north/daily/data/N_seaice_extent_daily_v3.0.csv>


## Question 1:

- Describe the data set: what are the columns and units? 
This data set represents the amount of Arctic sea ice from 1978 to the present. The temporal resolution is 1 day, and the spatial resolution is 25 by 25 km. The data is collected from various sensors operated by the National Snow and Ice Data Center. However, it should be noted that the data is best observed on a monthly scale rather than daily because monthly averages will average errors in the data and represent long-term weather more accurately than daily weather variations. 

## Question 2:

Construct the necessary R code to import this data set as a tidy `Table` object.
```{r}
arctic_ice <- read_csv("ftp://sidads.colorado.edu/DATASETS/NOAA/G02135/north/daily/data/N_seaice_extent_daily_v3.0.csv",
                     skip=2,
                     col_names=c("year", "month", "day", "extent", "missing",
                                 "source"),
                     col_types= c("iiiddc"))
arctic_ice
```


## Question 3:

Plot the data and describe the trends you observe.    
```{r}
arctic_ice |>
  group_by(year) |>
  summarise(mean_extent = mean(extent)) |>
  ggplot(aes(year, mean_extent)) + geom_line()
```
In general, there is an overall decrease in Arctic sea ice surface area. However, there are fluctuations in the data which could be attributed to fluctuations in global climate. For example, the past ten years have been some of the hottest on record. These higher tempertures would mean more sea ice would melt, contributing to these sharp decreases in mean ice extent. There also seems to be a sharp increase in the amount of sea ice in the past three years. 

# Exercise V: Longer term trends in CO2 Records

The data we analyzed in the unit introduction included CO2 records dating back only as far as the measurements at the Manua Loa observatory.  To put these values into geological perspective requires looking back much farther than humans have been monitoring atmosopheric CO2 levels.  To do this, we need another approach.

[Ice core data](http://cdiac.ornl.gov/trends/co2/ice_core_co2.html):

Vostok Core, back to 400,000 yrs before present day 

- Description of data set: <http://cdiac.esd.ornl.gov/trends/co2/vostok.html>
- Data source: <http://cdiac.ornl.gov/ftp/trends/co2/vostok.icecore.co2>
https://www.ncei.noaa.gov/pub/data/paleo/icecore/antarctica/vostok/vostok_co2.txt

## Questions / Tasks:

- Describe the data set: what are the columns and units? Where do the numbers come from? 


- What is the uncertainty in measurement? Resolution of the data? Interpretation of missing values?

- Read in and prepare data for analysis.
```{r}
vostok<- read_table("https://www.ncei.noaa.gov/pub/data/paleo/icecore/antarctica/vostok/co2-noaa.txt",
                  comment="#", 
                  skip=4,
                  show_col_types=FALSE)%>%
                  arrange(desc(gas_ageBP))
vostok
```

```{r}
vostok %>%
  ggplot()+
  geom_line(aes(x=gas_ageBP, y=CO2_mean))+
  scale_x_reverse()+
  ggtitle("Vostok CO2 Concentrations")

```





